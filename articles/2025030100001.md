---
title: "フリーWiFi利用時のリスクを整理する"
emoji: "🦆"
type: "idea"
topics:
  - "security"
published: true
published_at: "2025-03-01 00:00"
---

# なぜ作成したのか
- コワーキングスペースやカフェ等のフリーWiFiを使用する際のリスクについて具体的な脅威を理解し、「なんでダメなの！」と逆ギレされた場合のカウンターを準備しておく
---

# 参考
https://qiita.com/ockeghem/items/c6a3602d2c2409f89fbb
https://www.youtube.com/watch?v=GP1eEit1quY

# フリーWi-Fi利用時のセキュリティ脅威と防御策

 - 公共の場に設置されたWi-Fiセキュリティ注意喚起の広告例（インド・ムンバイの浜辺）。「無線通信は追加のセキュリティ付きで安全に利用しましょう。あなたはどうですか？」と呼びかけている ([File:Trash container with wifi security notice at Chowpatty Beach in Mumbai.jpg - Wikimedia Commons](https://commons.wikimedia.org/wiki/File:Trash_container_with_wifi_security_notice_at_Chowpatty_Beach_in_Mumbai.jpg#:~:text=Description%20Trash%20container%20with%20wifi,jpg))。

## はじめに
- コワーキングスペースやカフェで提供されるフリーWi-Fi（公衆無線LAN）は便利ですが、その利用にはセキュリティ上のリスクが伴います。
- 特にWindowsノートPCやMacBookなどのデバイスでフリーWi-Fiに接続する際、通信内容の盗聴や改ざんなど**様々な攻撃手法**の標的となり得ます。
- 以下では、技術者向けにフリーWi-Fi利用時の具体的な攻撃経路や手法、およびそれらが発生しやすい環境について詳しく解説し、最後に一般ユーザーが身を守るための防御策を述べます。

## フリーWi-Fi環境で狙われる主な攻撃手法

### 中間者攻撃（MITM: Man-in-the-Middle Attack）
- 中間者攻撃[^1]は、利用者（被害者）と通信相手（Webサーバ等）の間に攻撃者が割り込んで、データを盗聴・改ざんする手法です。 

[^1]: [中間者攻撃（MITM攻撃）とは？  |  サイバーセキュリティラボ](https://cyber-security-lab.jp/mimt/#:~:text=)

- たとえば攻撃者は同じWi-Fiネットワーク上で**ARPスプーフィング（ARPポイズニング）**を行い、自身のMACアドレスをルーターのアドレスになりすました偽のARP応答を被害者に送ります。
- その結果、被害者の端末は攻撃者マシンをルーターだと誤認し、通信経路が攻撃者経由に乗っ取られてしまいます。
- これによって、平文の通信内容はもちろん、場合によっては暗号化された通信も解除・傍受される危険があります。
- 実際、公衆Wi-Fiでは**通信データが暗号化されていない**場合も多く、攻撃者にとって不正傍受が容易な環境となっています。

### DNSスプーフィング（DNSキャッシュ汚染）
- DNSスプーフィング[^2]は、名前解決（ドメイン名→IPアドレス変換）の回答を偽装してターゲットを悪意あるサーバに誘導する攻撃です。

[^2]: [フリーWi-Fiにまつわるサイバー攻撃の脅威、9つの手口と対策 | TECH+（テックプラス）](https://news.mynavi.jp/techplus/article/20240215-2883447/)

- 例えば被害者が「example.com」にアクセスしようとした際に、攻撃者がそのDNSクエリに介入して「example.comのIPアドレス＝攻撃者のサーバ」という偽の応答を送りつけます。
- 被害者の端末はこれを信じて攻撃者の用意した偽サイトに接続してしまい、ログイン情報やクレジットカード情報などを入力させられる恐れがあります。
- フリーWi-Fiの利用時はDNS通信が暗号化されていないことが多いため、このような攻撃に対して脆弱です。

### Wi-Fiフィッシング（悪魔の双子攻撃 等）
- Wi-Fiフィッシング[^2]は、フィッシング詐欺の手口を無線LANに応用した攻撃で、ユーザーを騙して**偽のWi-Fiアクセスポイント**に接続させるものです。
- 代表的なのが **「悪魔の双子（Evil Twin）攻撃」** と呼ばれる手法で、攻撃者は本物とほぼ同一名称の偽Wi-Fiアクセスポイントを設置します。
- 利用者は正規のアクセスポイントと信じてこの偽Wi-Fiに接続してしまい、結果として全ての通信が攻撃者の管理下を通過します。
- 攻撃者はこの中間に入った通信を傍受・解析することで、機密情報を盗み出すことができます。
- 実際に「無料Wi-Fiあります」などと書かれたSSIDに人が引き寄せられるケース[^3]は多く、公共の場において攻撃者が同名のネットワークを用意するだけで、多くの利用者が罠にかかる可能性があります

[^3]: [フリーWi-Fiはなぜ「怖い」と思われる？　 ～危険性を犯罪者目線で考えてみた | Wi-Fiコラム Powered by NTTBP](https://www.ntt-bp.net/column/blog/2021/04/post-27.html)

### セッションハイジャック（サイドジャック）
- セッションハイジャック[^2]は、ユーザーがウェブサービスにログイン中の**セッションIDやトークン**を不正取得し、そのセッションを乗っ取る攻撃です。
- 攻撃者はフリーWi-Fi上を流れるクッキーなどのセッション情報を盗み出し、それを使って本人になりすましてサービスにアクセスします。
- これによりパスワード自体は漏れなくとも、攻撃者は被害者のアカウント権限で操作が可能になります。
- 特に過去には、暗号化されていないHTTP通信でセッションCookieをやり取りしていたSNSなどで、この手口（Firesheepなどのツールを用いたサイドジャック）が問題になりました。
- フリーWi-Fiのようなオープンネットワークでは、他人のセッション情報を傍受することが容易なため注意が必要です。

### SSLストリッピング
- SSLストリッピング[^1]は、本来HTTPSで行われるべき通信を攻撃者が強制的に **平文HTTPにダウングレード** させる攻撃です。
- 攻撃者がMITM攻撃によってユーザーとWebサイトの中間に入り込み、ユーザーが`https://`でアクセスしたリクエストを横取りして、一旦自分でサイトにHTTPS接続します。
- その上で、ユーザーには **暗号化されていないHTTPページ** を転送し直すことで、ユーザーから攻撃者までは平文通信にさせてしまいます。
- ユーザーはURL欄の「http://」に気付かない限り通常のサイトと同様に入力を続けてしまい、送信されたパスワードや個人情報は暗号化されず攻撃者に筒抜けになります。
- 本来HTTPSサイトであれば第三者に見られないはずの通信を盗聴できてしまう点で非常に危険です。

### 不正なアクセスポイント（Rogue AP）
- 上記のWi-Fiフィッシングと関連しますが、攻撃者自身が用意した **悪意あるWi-Fiアクセスポイント** 自体を指す場合、「不正AP（アクセスポイント）」[^2]と呼びます。
- 例えばカフェ等で提供されている正規のSSIDとは別に、攻撃者が似たような名前（あるいは全く関係ない名前）の無料Wi-Fiを開設して待ち構えるケースです。
- 利用者が誤ってこのアクセスポイントに接続すると、以降の通信はすべて攻撃者を経由するため、MITM攻撃やフィッシング、マルウェア配布などあらゆる悪事が可能となります。
- **悪魔の双子（Evil Twin）** は正規APを装う点で一種の不正APと言えますが、それ以外にも「野良Wi-Fi」と俗称される設置者不明のアクセスポイント全般がリスクとなり得ます。
- 不正APは設定自体は違法ではないため誰でも仕掛けられ、攻撃の痕跡も残りにくい厄介な存在です[^3]。

### ARPポイズニング（ARPスプーフィング）
- ARP（アドレス解決プロトコル）ポイズニング[^1]は、ローカルネットワーク内でIPアドレスに対応するMACアドレス情報を偽装し、通信経路を乗っ取る攻撃です。
- 前述したMITMの具体的実現手法の一つであり、ARP自体に認証機構が無いため成立します。
- 攻撃者は被害者に対し「ルーターのMACアドレスは自分（攻撃者）のMACだ」と嘘のARP応答を送りつけ、被害者のARPテーブルを書き換えます。
- 結果として、被害者のあて先（ゲートウェイ）が攻撃者にすり替わり、**ローカルLAN内の通信を傍受・改ざん** できるようになります。
- ARPポイズニング自体は通信を盗み見るための下準備ですが、この後に行われるセッションハイジャックやSSLストリッピングなど、他の攻撃の土台となる非常に危険な技術です。
- フリーWi-Fiの多くは **同一ネットワーク内で他端末とのやり取りを遮断していない** ため、この攻撃が仕掛けられやすい環境と言えます。

### その他の攻撃手法
- フリーWi-Fi環境では上記以外にも様々な手口が考えられます。

- **パケットスニッフィング（盗聴）**[^2]：
  - 攻撃者が専用ツールを使い、無線LAN上を流れるパケットをただ傍受・収集する行為です。
  - オープンなWi-Fiでは通信が暗号化されていないため、Webの閲覧履歴や入力データがそのまま見られてしまいます[^3]。
  - 収集したパケットデータは後から解析することで、ログイン情報や通信内容を復元できる可能性があります[^2]。 
  - [フリーWi-Fiにまつわるサイバー攻撃の脅威、9つの手口と対策 | TECH+（テックプラス）](https://news.mynavi.jp/techplus/article/20240215-2883447/)にある通り、この行為自体は地域によっては違法とみなされない場合もあり、悪意ある者に悪用される恐れがあります。
- **ショルダーサーフィン** [^2]：
  - ネットワーク経由ではありませんが、公共の場では **肩越しの覗き見** にも警戒が必要です。
  - カフェ等でPC画面やキーボードを直接盗み見られ、パスワードやクレジットカード番号を盗まれるケースです。
  - 古典的な手法ですが効果的であり、実際に公衆無線LANがある空間で被害報告があります。
- **悪質なソフトウェアの仕込み** [^2]：
  - フリーWi-Fi利用者を狙って、偽のソフトウェア更新通知やドライバインストールを表示し、マルウェアをインストールさせる攻撃もあります。
  - あるいは公共の場所に設置された共用PCそのものに **キーロガー** （入力記録ソフト）[^2] を忍ばせ、利用者の入力情報を後で抜き取る手口も存在します。
  - フリーWi-Fi環境は利用者の警戒心が薄れやすく、「無料サービス利用のためのインストール」と偽って不正プログラムを実行させるには格好の機会です。

## こうした攻撃が発生しやすい環境・条件
- 上記の攻撃は、主に **セキュリティ対策が不十分なWi-Fi環境** で成功しやすくなります。以下にその典型例を挙げます。

  - **暗号化されていないオープンWi-Fi**：
    - パスワード不要で接続できるSSID（鍵マークの無いWi-Fi）は通信が暗号化されていません。
    - そのため電波を受信できる範囲内であれば誰でもパケットを傍受でき、盗聴やセッションハイジャックなどのリスクが非常に高くなります。
    - 攻撃者にとって最も好都合な環境であり、「あなたの通信見えてますよ」と言われるような状況です。
  - **認証・確認機能のないネットワーク**：
    - 利用者ごとのログイン認証や、接続時に証明書を用いたサーバ検証を行わないWi-Fiでは、攻撃者がネットワークを偽装しやすくなります。
    - いわゆるカフェの共通パスワード方式（WPA2-PSK）も、パスワード自体は暗号鍵になりますが、それを知る者であればネットワークに参加できてしまいます。
    - 共有鍵方式のWi-Fiではクライアント間通信が遮断されていない限り、同じ鍵を持つ攻撃者はARPスプーフィングやDNS偽装を仕掛ける土壌に入れることになります。
  - **プロトコル上の既知の脆弱性**：
    - ARPやDNS、HTTPなど、設計上セキュリティが脆弱なプロトコルを使用している環境は狙われやすいです。例えばARPは前述の通り認証が無く偽装容易、DNSも通信が平文のため応答を改ざんされ得ます。
    - またWebサイト側がHTTPSを正しく実装していなかったり、メール送受信に暗号化されていないPOP/IMAPを使っていたりすると、攻撃成功の確率が上がります。
    - 攻撃者はこうした弱点のある通信を狙ってMITMやSSLストリップを行います。
  - **利用者側の設定や習慣**：
    - デバイスが「自動で開放的なWi-Fiに接続する設定」になっていると、攻撃者の偽APに気付かず繋がってしまう危険があります。
    - 過去に接続したSSIDを端末が記憶し、自動再接続しにいく動作を利用して、攻撃者が一般的なSSID名（例：「Free_Wi-Fi」「Starbucks_WiFi」等）で電波を発信し待ち受けることも可能です。
    - また人が多く集まるイベント会場や駅・空港などは、不特定多数を狙った偽Wi-Fiが設置されやすい環境 [^3] と言われています。
    - 利用者が急いで通信したい心理につけ込み、安易に接続させる狙いがあります。

- 以上のように、**未対策のオープンネットワーク**や**利用者の油断**が重なるとき、フリーWi-Fiはサイバー攻撃者にとって絶好の狩り場となります。

## 一般ユーザーのための具体的な防御策
- フリーWi-Fi利用時のリスクを軽減するために、以下のような実践的対策を講じることが重要です。

- **HTTPS接続を優先し、警告を無視しない**：
  - ウェブサイト利用時は可能な限りURLが「https://」で始まる安全な接続を使いましょう。
    - ブラウザが証明書エラーや「このサイトは安全ではありません」という警告を出した場合、絶対にログイン情報や個人情報を入力しないでください。
    - それは **中間者によるSSL偽装の兆候** かもしれません。
- **SSIDをよく確認し、不審なWi-Fiには繋がらない**：
  - 似たような名前のネットワークが複数表示されたら要注意です。
    - 例えば「Cafe_WiFi」と「CafeFreeWifi」など紛らわしいSSIDがあれば、安易に接続せずお店のスタッフに公式なSSIDか確認しましょう。
    - 攻撃者の偽APを避けるため、**SSID名だけで判断せず慎重に選ぶ** ことが大切です。
- **信頼できるVPNの利用**：
  - できる限り**VPN（仮想プライベートネットワーク）**を使って通信を暗号化してください。
    - VPNを使用すれば、フリーWi-Fi上の通信内容は暗号化トンネル内を通るため、たとえ盗聴されても解読されにくくなります。
    - 特に機密情報を扱う場合や、不特定多数のネットワークに接続する場合はVPNで自衛するのが効果的です。
- **利用後のログアウト徹底**：
  - ウェブサービス利用後は必ずログアウトし、セッション情報を残さないようにしましょう。
    - ログインしっぱなしにしているとセッションハイジャックの危険が高まります。
    - 不審な端末から自分のアカウントにアクセスされていないか、ログイン履歴のチェックやセッションの強制無効化も習慣づけてください。
- **周囲の環境に注意する**：
  - パスワードやクレジットカード番号など機密情報を入力するときは、背後に人の視線がないか確認しましょう。
    - 肩越しに見られていないか、入力時にキーボードを手で隠すなど物理的な対策も忘れないでください。
- **安全なDNSサービスの利用**：
  - DNSクエリの盗聴や改ざん対策として、DNS over HTTPSやDNS over TLSなど暗号化DNSサービスを利用するのも有効です。
  - またはVPNを使うことでDNSリクエストも含め保護できます。
  - 少なくともフリーWi-Fi利用時には、通信が暗号化されない従来のDNSをそのまま使わない工夫が望まれます。
- **不要な個人情報は提供しない**：
  - 接続時に過剰な個人情報入力を求めるような公衆Wi-Fiは利用を控えましょう。
    - メールアドレスや電話番号を要求してくる不審なログインページはフィッシングの可能性があります。
    - どうしても使う必要がある場合でも、使い捨ての情報を入力するなどして本来の個人情報を守ってください。
- **ネットワークを「公開」扱いに設定**：
  - Windows PCではフリーWi-Fiに接続したらネットワークプロファイルを「パブリック（公開）」に設定し、ファイル共有やデバイス検出を無効化しましょう。
  - Macでもファイアウォールを有効にし、ファイル共有機能はオフにすることを推奨します。
    - これにより、**同じネットワーク上の他人からデバイス内部にアクセスされるリスク** を減らせます。
- **自動接続機能の見直し**：
  - 端末のWi-Fi自動接続設定を確認し、知らないSSIDには自動で繋がらないようにしましょう。
    - 過去に接続したネットワーク情報は不要であれば削除し、悪意あるアクセスポイントへの誤接続を防ぎます。
- **最新のセキュリティアップデート適用**：
  - OS（WindowsやmacOS）やブラウザ、セキュリティソフトは常に最新の状態に保ちます。
  - 最新アップデートにはセキュリティ強化が含まれており、既知の脆弱性（例えば古いプロトコルの脆弱性やSSL証明書検証の不備など）の悪用を防ぐ助けとなります。


## おわりに
- フリーWi-Fiは便利な反面、多種多様な攻撃の舞台となり得ます。
- 本稿で解説したように、MITM攻撃をはじめDNSスプーフィングやWi-Fiフィッシング、セッションハイジャック、SSLストリッピング、悪意あるAPの設置、ARPポイズニングなど、その手口は巧妙です。
- こうした攻撃は主にオープンな無線環境や利用者の油断につけ込んで成立します。
- しかし適切な知識と対策をもってすれば、リスクを最小化し安全に公共Wi-Fiを活用することができます。
- 技術者の方はもちろん一般ユーザーに対しても、**「フリーWi-Fiを使う＝常に攻撃者が潜んでいるかもしれない」** との意識で、防御策を徹底するよう啓発していくことが重要です。安全なネット利用の心得を持ち、便利なサービスをリスクなく楽しみましょう。

