---
title: "ã€GASã€‘å‰¯æ¥­ç”³è«‹ã‚¢ãƒ—ãƒªã‚’ä½œã‚ã†"
emoji: "ğŸ¦†"
type: "idea"
topics:
  - "GAS"
published: true
published_at: "2025-04-12 12:00"
---

# ãªãœä½œæˆã—ãŸã®ã‹
- ã‚‚ã†ã¡ã‚‡ã£ã¨ç®¡ç†è² è·ã‚’ç”³è«‹è€…ã«ã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚¢ãƒ—ãƒªã‚’ä½œã‚ŠãŸã„

# è³ªå•ï¼‘ï¼ˆto ChatGPTï¼‰

> Spreadsheet,Appsheet,Slackã§ç¤¾å“¡ã®å‰¯æ¥­ç”³è«‹ã€å‰¯æ¥­ã®ç¶™ç¶šçŠ¶æ³ç›£è¦–ã‚’ã—ãŸã„ã§ã™ã€‚
> ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
> - ç¤¾å“¡
> - ç®¡ç†è€…
> 
> ï¼‘ï¼ç”³è«‹
> 
> ç¤¾å“¡ã¯å‰¯æ¥­ã‚’è¡Œã†å ´åˆã«Appsheetã‹ã‚‰å‰¯æ¥­ç”³è«‹ã‚’è¡Œã„ã¾ã™ã€‚
> ç”³è«‹å†…å®¹ã¯æœ¬äººã¨ç®¡ç†è€…ã«ã—ã‹è¦‹ãˆã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚
> ç”³è«‹ã™ã‚‹å†…å®¹ã¯ä»¥ä¸‹ã§ã™ã€‚
> - å‰¯æ¥­å†…å®¹
> - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
> - æœˆã®ç¨¼åƒè¦‹è¾¼ã¿æ™‚é–“
> - é–‹å§‹æ—¥
> - çµ‚äº†æ—¥
> - ç”³è«‹è€…
> - ç”³è«‹æ—¥
>
> ç”³è«‹ãƒ‡ãƒ¼ã‚¿ã¯Spreadsheetã§ç®¡ç†ã—ã¾ã™ã€‚
> 
> ç”³è«‹ãŒç™ºè¡Œã•ã‚ŒãŸã‚‰ã€Slackã®ç”³è«‹é€šçŸ¥ç”¨ãƒãƒ£ãƒ³ãƒãƒ«ã«ç®¡ç†è€…ã‚ã¦ã®ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¦Postã—ã¾ã™ã€‚
> ç®¡ç†è€…ã¯ç”³è«‹å†…å®¹ã‚’Appsheetã§ç¢ºèªã—ã€å•é¡Œãªã‘ã‚Œã°æ‰¿èªã—ã¾ã™ã€‚å•é¡ŒãŒã‚ã‚Œã°å•é¡Œç‚¹ã‚’å…¥åŠ›ã—ã€å´ä¸‹ã—ã¾ã™ã€‚
> æ‰¿èªæ™‚ã«ã€ä»¥ä¸‹ã®æ‰¿èªè¨˜éŒ²ã‚’æ®‹ã—ã¾ã™ã€‚
> - æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
> - æ‰¿èªè€…
> - æ‰¿èªæ—¥æ™‚
> - æ‰¿èªè€…ã‚³ãƒ¡ãƒ³ãƒˆ
> æ‰¿èªãƒ»å´ä¸‹ãŒè¡Œã‚ã‚ŒãŸã‚‰ã€Slackbotã‹ã‚‰ç”³è«‹ã‚’è¡Œã£ãŸç¤¾å“¡ã«DMã§é€šçŸ¥ã—ã¾ã™ã€‚
>
> ï¼’ï¼ç¶™ç¶šç›£è¦–
> ç”³è«‹ã•ã‚ŒãŸå‰¯æ¥­ã®é–‹å§‹æ—¥ã€çµ‚äº†æ—¥ã«åŸºã¥ãã€æ¯æœˆï¼‘æ—¥ã«ç”³è«‹ã‚’è¡Œã£ãŸç¤¾å“¡ã¸DMã§ç¢ºèªã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’DMã—ã¾ã™ã€‚
> DMã«ã¯ã€Œç¨¼åƒä¸­ã€ã€Œç¨¼åƒãªã—ã€ã€Œå‰¯æ¥­çµ‚äº†ã€ã®ãƒœã‚¿ãƒ³ã‚’è¨­ç½®ã—ã€è©²å½“ã®ç¤¾å“¡ã¯ã„ãšã‚Œã‹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
> ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰ã€å›ç­”å†…å®¹ã‚’ã‚‚ã¨ã«Spreadsheetã«ä»¥ä¸‹ã®æƒ…å ±ã‚’è¿½åŠ ã—ã¾ã™ã€‚
> - å¹´
> - æœˆ
> - å›ç­”
> - å›ç­”è€…
> - å›ç­”æ—¥
> ç¤¾å“¡ã¯å›ç­”ã—ãŸå†…å®¹ã‚’Appsheetã‹ã‚‰ã€å‰¯æ¥­ç”³è«‹ãƒ‡ãƒ¼ã‚¿ã«ç´ã¥ãå½¢ã§ç¢ºèªã€ä¿®æ­£ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
>
> ç®¡ç†è€…ã¯å„ç¤¾å“¡ã‹ã‚‰ã®å›ç­”çŠ¶æ³ã‚’Appsheetã‹ã‚‰ç¢ºèªã—ã¾ã™ã€‚
> ç®¡ç†è€…ãŒAppsheetã‹ã‚‰æœªå›ç­”è€…ã‚’ç¢ºèªã—ã€ç£ä¿ƒãŒã§ãã‚‹ã‚ˆã†ã«ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€ã¾ãŸã¯æœˆåˆ¥æœªå›ç­”ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
> 
> å½“è©²æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
> ã¾ãšå‡¦ç†ã‚’Markdownæ›¸å¼ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã¨ã—ã¦æ•´ç†ã—ã¦ä¸‹ã•ã„ã€‚
> åŒæ§˜ã«ã‚¯ãƒ©ã‚¹å›³ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
> æœ€å¾Œã«ã‚¯ãƒ©ã‚¹å›³ã‚’ã‚‚ã¨ã«Spreadsheetã®åˆ—è¨­è¨ˆã‚’è¡Œã£ã¦ãã ã•ã„ã€‚


# å›ç­”ï¼‘
ä»¥ä¸‹ã«ã”è¦æœ›ã®æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹ã«åŸºã¥ã„ã¦ã€å‡¦ç†ã®æµã‚Œã‚’æ•´ç†ã—ãŸ**Markdownå½¢å¼ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³**ã€**ã‚¯ãƒ©ã‚¹å›³**ã€ãŠã‚ˆã³**Spreadsheetã®åˆ—è¨­è¨ˆ**ã‚’æç¤ºã—ã¾ã™ã€‚

---

## ğŸ” ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³

```mermaid
sequenceDiagram
    participant ç¤¾å“¡
    participant AppSheet
    participant Spreadsheet
    participant Slacké€šçŸ¥ãƒãƒ£ãƒ³ãƒãƒ«
    participant ç®¡ç†è€…
    participant Slack DM

    %% ç”³è«‹ãƒ•ã‚§ãƒ¼ã‚º
    ç¤¾å“¡->>AppSheet: å‰¯æ¥­ç”³è«‹ã‚’å…¥åŠ›
    AppSheet->>Spreadsheet: ç”³è«‹ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    Spreadsheet-->>Slacké€šçŸ¥ãƒãƒ£ãƒ³ãƒãƒ«: ç®¡ç†è€…ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ä»˜ãã§é€šçŸ¥
    ç®¡ç†è€…->>AppSheet: ç”³è«‹å†…å®¹ã‚’ç¢ºèª
    ç®¡ç†è€…->>AppSheet: æ‰¿èª or å´ä¸‹ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå«ã‚€ï¼‰
    AppSheet->>Spreadsheet: æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç­‰ã‚’æ›´æ–°
    Spreadsheet-->>Slack DM: ç”³è«‹è€…ã«æ‰¿èª/å´ä¸‹ã‚’DMé€šçŸ¥

    %% ç¶™ç¶šç¢ºèªãƒ•ã‚§ãƒ¼ã‚º
    loop æ¯æœˆ1æ—¥
        Slacké€šçŸ¥ãƒãƒ£ãƒ³ãƒãƒ«->>Slack DM: è©²å½“ç¤¾å“¡ã«ç¶™ç¶šç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆãƒœã‚¿ãƒ³ä»˜ãï¼‰
        ç¤¾å“¡->>Slack DM: ã€Œç¨¼åƒä¸­ã€ã€Œç¨¼åƒãªã—ã€ã€Œå‰¯æ¥­çµ‚äº†ã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
        Slack DM->>Spreadsheet: å›ç­”å†…å®¹ã‚’è¨˜éŒ²
    end

    ç¤¾å“¡->>AppSheet: å›ç­”å±¥æ­´ã®ç¢ºèªãƒ»ä¿®æ­£
    ç®¡ç†è€…->>AppSheet: å›ç­”çŠ¶æ³ã®ç¢ºèª
    ç®¡ç†è€…->>AppSheet: æœªå›ç­”è€…ã®ãƒªã‚¹ãƒˆãƒ»ç£ä¿ƒ
```

---

## ğŸ§± ã‚¯ãƒ©ã‚¹å›³

```mermaid
classDiagram
    class User {
        +ç¤¾å“¡ID
        +æ°å
        +Slackãƒ¦ãƒ¼ã‚¶ãƒ¼ID
        +å½¹å‰²ï¼ˆç¤¾å“¡/ç®¡ç†è€…ï¼‰
    }

    class Application {
        +ç”³è«‹ID
        +ç”³è«‹è€…ID
        +å‰¯æ¥­å†…å®¹
        +ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
        +æœˆã®ç¨¼åƒè¦‹è¾¼ã¿æ™‚é–“
        +é–‹å§‹æ—¥
        +çµ‚äº†æ—¥
        +ç”³è«‹æ—¥
        +æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
        +æ‰¿èªè€…ID
        +æ‰¿èªæ—¥æ™‚
        +æ‰¿èªè€…ã‚³ãƒ¡ãƒ³ãƒˆ
    }

    class MonthlyStatus {
        +ç”³è«‹ID
        +å¹´
        +æœˆ
        +å›ç­”
        +å›ç­”è€…ID
        +å›ç­”æ—¥
    }

    User "1" --> "0..*" Application : creates
    User "1" --> "0..*" MonthlyStatus : submits
    Application "1" --> "0..*" MonthlyStatus : linked to
```

---

## ğŸ“Š Spreadsheetåˆ—è¨­è¨ˆ

### 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã‚·ãƒ¼ãƒˆï¼ˆUsersï¼‰

| ç¤¾å“¡ID | æ°å | Slackãƒ¦ãƒ¼ã‚¶ãƒ¼ID | å½¹å‰²ï¼ˆç¤¾å“¡/ç®¡ç†è€…ï¼‰ |
|--------|------|------------------|---------------------|
| U001   | å±±ç”°å¤ªéƒ | @yamada          | ç¤¾å“¡                |
| U002   | ä½è—¤èŠ±å­ | @sato            | ç®¡ç†è€…              |

---

### 2. å‰¯æ¥­ç”³è«‹ã‚·ãƒ¼ãƒˆï¼ˆApplicationsï¼‰

| ç”³è«‹ID | ç”³è«‹è€…ID | å‰¯æ¥­å†…å®¹ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ | æœˆã®ç¨¼åƒè¦‹è¾¼ã¿æ™‚é–“ | é–‹å§‹æ—¥ | çµ‚äº†æ—¥ | ç”³è«‹æ—¥ | æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | æ‰¿èªè€…ID | æ‰¿èªæ—¥æ™‚ | æ‰¿èªè€…ã‚³ãƒ¡ãƒ³ãƒˆ |
|--------|-----------|----------|--------------|---------------------|--------|--------|--------|----------------|------------|------------|------------------|
| A001   | U001      | Webåˆ¶ä½œ | æ ªå¼ä¼šç¤¾ABC | 20æ™‚é–“              | 2025/04/01 | 2025/09/30 | 2025/03/15 | æ‰¿èª | U002 | 2025/03/16 | å•é¡Œãªã—        |

---

### 3. æœˆæ¬¡å ±å‘Šã‚·ãƒ¼ãƒˆï¼ˆMonthlyStatusï¼‰

| ãƒ¬ã‚³ãƒ¼ãƒ‰ID | ç”³è«‹ID | å¹´ | æœˆ | å›ç­” | å›ç­”è€…ID | å›ç­”æ—¥ |
|------------|--------|----|----|------|------------|---------|
| R001       | A001   | 2025 | 04 | ç¨¼åƒä¸­ | U001 | 2025/04/01 |

---

# è³ªå•ï¼’ï¼ˆto ChatGPTï¼‰

> ã“ã“ã¾ã§ã®è¨­è¨ˆæƒ…å ±ã‚’ã‚‚ã¨ã«ã€Slacké€šçŸ¥ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

# å›ç­”ï¼’

Slacké€šçŸ¥ã®æ©Ÿèƒ½ã¨ã—ã¦ã€æ¬¡ã®2ã¤ã‚’Google Apps Scriptï¼ˆGASï¼‰ã§å®Ÿè£…ã—ã¾ã™ã€‚

---

## âœ… æ©Ÿèƒ½ä¸€è¦§

### â‘  ç®¡ç†è€…ã¸ã®å‰¯æ¥­ç”³è«‹é€šçŸ¥ï¼ˆSlackãƒãƒ£ãƒ³ãƒãƒ«ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
- AppSheetçµŒç”±ã§Spreadsheetã«æ–°è¦ç”³è«‹ãŒè¿½åŠ ã•ã‚ŒãŸã¨ãã«ã€Slackãƒãƒ£ãƒ³ãƒãƒ«ã¸ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ä»˜ãã§é€šçŸ¥ã€‚

### â‘¡ ç¤¾å“¡ã¸ã®æ‰¿èªï¼å´ä¸‹é€šçŸ¥ï¼ˆSlack DMï¼‰
- ç®¡ç†è€…ãŒAppSheetã§æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°ã—ãŸã‚‰ã€è©²å½“ç¤¾å“¡ã«DMé€šçŸ¥ã€‚

---

## ğŸ“¦ äº‹å‰æº–å‚™ï¼ˆSlack Botè¨­å®šï¼‰

1. [Slack API: Apps](https://api.slack.com/apps) ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ–°ã—ã„ã‚¢ãƒ—ãƒªã‚’ä½œæˆã€‚
2. OAuth & Permissions ã«ã¦ä»¥ä¸‹ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‚’è¨­å®š:
   - `chat:write`
   - `users:read`
   - `im:write`
3. Bot Token ã‚’å–å¾—ã—ã¦ã€GASã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« `SLACK_BOT_TOKEN` ã¨ã—ã¦ä¿å­˜ã€‚
4. é€šçŸ¥å…ˆãƒãƒ£ãƒ³ãƒãƒ«IDï¼ˆä¾‹: `å‰¯æ¥­ç”³è«‹é€šçŸ¥ç”¨`ï¼‰ã‚’èª¿ã¹ã¦ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« `SLACK_NOTIFY_CHANNEL_ID` ã‚’ä¿å­˜ã€‚

---

## ğŸ§© GASã‚³ãƒ¼ãƒ‰ï¼šSlacké€šçŸ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```javascript
// Slackè¨­å®š
const SLACK_TOKEN = PropertiesService.getScriptProperties().getProperty("SLACK_BOT_TOKEN");
const SLACK_NOTIFY_CHANNEL_ID = PropertiesService.getScriptProperties().getProperty("SLACK_NOTIFY_CHANNEL_ID");

// ç¤¾å“¡æƒ…å ±ã‚’å–å¾—ï¼ˆSlack IDå–å¾—ç”¨ï¼‰
function getUserMap() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Users");
  const rows = sheet.getDataRange().getValues();
  const map = {};
  for (let i = 1; i < rows.length; i++) {
    const [userId, name, slackId, role] = rows[i];
    map[userId] = { name, slackId, role };
  }
  return map;
}

// â‘  ç®¡ç†è€…ã¸å‰¯æ¥­ç”³è«‹é€šçŸ¥
function notifyNewApplication() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Applications");
  const lastRow = sheet.getLastRow();
  const row = sheet.getRange(lastRow, 1, 1, sheet.getLastColumn()).getValues()[0];

  const [ç”³è«‹ID, ç”³è«‹è€…ID, å‰¯æ¥­å†…å®¹, ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ, æœˆæ™‚é–“, é–‹å§‹æ—¥, çµ‚äº†æ—¥, ç”³è«‹æ—¥] = row;

  const users = getUserMap();
  const ç®¡ç†è€… = Object.values(users).find(user => user.role === "ç®¡ç†è€…");
  if (!ç®¡ç†è€…) return;

  const message = `
ğŸ“® *æ–°ã—ã„å‰¯æ¥­ç”³è«‹ãŒå±Šãã¾ã—ãŸ*
ç”³è«‹è€…: ${users[ç”³è«‹è€…ID]?.name}
å‰¯æ¥­å†…å®¹: ${å‰¯æ¥­å†…å®¹}
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ: ${ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ}
æœˆã®ç¨¼åƒè¦‹è¾¼ã¿æ™‚é–“: ${æœˆæ™‚é–“}
æœŸé–“: ${é–‹å§‹æ—¥} ï½ ${çµ‚äº†æ—¥}
ç”³è«‹æ—¥: ${ç”³è«‹æ—¥}
<@${ç®¡ç†è€….slackId}> ã”ç¢ºèªãã ã•ã„ã€‚
`;

  postSlackMessage(SLACK_NOTIFY_CHANNEL_ID, message);
}

// â‘¡ æ‰¿èª or å´ä¸‹é€šçŸ¥ã‚’ç”³è«‹è€…ã«DM
function notifyApprovalStatus() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Applications");
  const lastRow = sheet.getLastRow();
  const row = sheet.getRange(lastRow, 1, 1, sheet.getLastColumn()).getValues()[0];

  const [ç”³è«‹ID, ç”³è«‹è€…ID, , , , , , , æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹, æ‰¿èªè€…ID, æ‰¿èªæ—¥æ™‚, æ‰¿èªè€…ã‚³ãƒ¡ãƒ³ãƒˆ] = row;

  const users = getUserMap();
  const ç”³è«‹è€…SlackId = users[ç”³è«‹è€…ID]?.slackId;
  const æ‰¿èªè€…å = users[æ‰¿èªè€…ID]?.name;

  if (!ç”³è«‹è€…SlackId || !æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹) return;

  const message = `
ğŸ“¢ *å‰¯æ¥­ç”³è«‹ã®çµæœé€šçŸ¥*
ã‚ãªãŸã®ç”³è«‹ï¼ˆID: ${ç”³è«‹ID}ï¼‰ã¯ *${æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹}* ã•ã‚Œã¾ã—ãŸã€‚

æ‰¿èªè€…: ${æ‰¿èªè€…å}
æ—¥æ™‚: ${æ‰¿èªæ—¥æ™‚}
ã‚³ãƒ¡ãƒ³ãƒˆ: ${æ‰¿èªè€…ã‚³ãƒ¡ãƒ³ãƒˆ || "ï¼ˆãªã—ï¼‰"}
`;

  postSlackMessageToUser(ç”³è«‹è€…SlackId, message);
}

// Slackãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ï¼ˆãƒãƒ£ãƒ³ãƒãƒ«å‘ã‘ï¼‰
function postSlackMessage(channelId, message) {
  const url = "https://slack.com/api/chat.postMessage";
  const payload = {
    channel: channelId,
    text: message,
    mrkdwn: true,
  };

  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${SLACK_TOKEN}`,
    },
    payload: JSON.stringify(payload),
  };

  UrlFetchApp.fetch(url, options);
}

// Slack DMé€ä¿¡
function postSlackMessageToUser(slackUserId, message) {
  // DMãƒãƒ£ãƒ³ãƒãƒ«ã‚’é–‹ã
  const imOpenUrl = "https://slack.com/api/conversations.open";
  const imOptions = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${SLACK_TOKEN}`,
    },
    payload: JSON.stringify({ users: slackUserId }),
  };
  const response = JSON.parse(UrlFetchApp.fetch(imOpenUrl, imOptions).getContentText());
  const channelId = response.channel.id;

  postSlackMessage(channelId, message);
}
```

---

## â° ãƒˆãƒªã‚¬ãƒ¼è¨­å®šï¼ˆAppSheeté€£æºï¼‰

- `notifyNewApplication`ï¼š
  - AppSheetã§ã€Œæ–°ã—ã„è¡ŒãŒè¿½åŠ ã•ã‚ŒãŸã¨ãã€ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«è¨­å®šï¼ˆGASãƒˆãƒªã‚¬ãƒ¼ or AppSheetã‹ã‚‰Webhooké€£æºï¼‰
- `notifyApprovalStatus`ï¼š
  - AppSheetã§ã€Œæ—¢å­˜ã®è¡ŒãŒæ›´æ–°ã•ã‚ŒãŸã¨ãã€ï¼ˆæ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒå¤‰ã‚ã£ãŸã¨ãï¼‰ã«å®Ÿè¡Œ

---

## âœ… æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

- æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å¤‰æ›´ã‚’æ¤œçŸ¥ã™ã‚‹ãƒˆãƒªã‚¬ãƒ¼ã‚’AppSheetã¾ãŸã¯GASã§ã©ã†å®Ÿè£…ã™ã‚‹ã‹ã€‚
- ç¶™ç¶šç¢ºèªDMã®ãƒœã‚¿ãƒ³ä»˜ãé€šçŸ¥ï¼ˆSlack Block Kitï¼‰ã¸ã®æ‹¡å¼µã€‚

ã“ã®éƒ¨åˆ†ã‚‚å«ã‚ã¦ã€ç¶™ç¶šç¢ºèªã®é€šçŸ¥å‡¦ç†ã‚‚å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã‹ï¼Ÿ


# è³ªå•ï¼“ï¼ˆto ChatGPTï¼‰

> ç¶™ç¶šç¢ºèªã®é€šçŸ¥å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

# å›ç­”ï¼“

äº†è§£ã§ã™ï¼ä»¥ä¸‹ã«ã€**ç¶™ç¶šç¢ºèªã®Slacké€šçŸ¥å‡¦ç†ï¼ˆç¤¾å“¡ã¸ã®DM + ãƒœã‚¿ãƒ³ä»˜ãå›ç­” + å›ç­”çµæœã®è¨˜éŒ²ï¼‰**ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

---

## âœ… å‡¦ç†æ¦‚è¦ï¼ˆæ¯æœˆ1æ—¥ï¼‰

1. Spreadsheetã€ŒApplicationsã€ã‹ã‚‰ã€çµ‚äº†æ—¥ãŒéãã¦ã„ãªã„ç”³è«‹ã‚’æŠ½å‡ºã€‚
2. å„è©²å½“ç¤¾å“¡ã«ã€Slack DMã§ãƒœã‚¿ãƒ³ä»˜ãã€Œç¶™ç¶šç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚’é€ä¿¡ã€‚
3. ç¤¾å“¡ãŒãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚‰ã€GASã®Webhookï¼ˆ`doPost`) ãŒå—ä¿¡ã€‚
4. æŠ¼ã•ã‚ŒãŸå†…å®¹ã‚’ã‚‚ã¨ã«ã€ã€ŒMonthlyStatusã€ã‚·ãƒ¼ãƒˆã¸å›ç­”ã‚’è¨˜éŒ²ã€‚

---

## ğŸ“ Spreadsheetæ§‹æˆï¼ˆå†æ²ï¼‰

- `Applications`ï¼šå‰¯æ¥­ç”³è«‹ä¸€è¦§
- `MonthlyStatus`ï¼šæœˆæ¬¡ã®ç¶™ç¶šç¢ºèª
- `Users`ï¼šç¤¾å“¡æƒ…å ±ï¼ˆSlackãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚ã‚Šï¼‰

---

## ğŸ§© GASã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆç¶™ç¶šç¢ºèªé€šçŸ¥ï¼†å›ç­”è¨˜éŒ²ï¼‰

### â‘  æ¯æœˆ1æ—¥ã®é€šçŸ¥ãƒˆãƒªã‚¬ãƒ¼å‡¦ç†

```javascript
function sendMonthlyStatusCheck() {
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth() + 1;

  const appsSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Applications");
  const userMap = getUserMap();
  const rows = appsSheet.getDataRange().getValues();
  const headers = rows[0];
  const applications = rows.slice(1);

  applications.forEach(app => {
    const [ç”³è«‹ID, ç”³è«‹è€…ID, , , , é–‹å§‹æ—¥, çµ‚äº†æ—¥] = app;
    const start = new Date(é–‹å§‹æ—¥);
    const end = new Date(çµ‚äº†æ—¥);

    // å¯¾è±¡ã®æœˆå†…ã«æ´»å‹•æœŸé–“ãŒå«ã¾ã‚Œã‚‹ç”³è«‹ã®ã¿é€šçŸ¥
    if (today >= start && today <= end) {
      const slackId = userMap[ç”³è«‹è€…ID]?.slackId;
      if (slackId) {
        sendStatusCheckMessage(slackId, ç”³è«‹ID, year, month);
      }
    }
  });
}
```

---

### â‘¡ Slackã«ãƒœã‚¿ãƒ³ä»˜ããƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡

```javascript
function sendStatusCheckMessage(slackUserId, applicationId, year, month) {
  const url = "https://slack.com/api/conversations.open";
  const imResponse = UrlFetchApp.fetch(url, {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${SLACK_TOKEN}`,
    },
    payload: JSON.stringify({ users: slackUserId }),
  });

  const imData = JSON.parse(imResponse.getContentText());
  const channelId = imData.channel.id;

  const message = {
    channel: channelId,
    text: `å‰¯æ¥­ç¶™ç¶šçŠ¶æ³ã®ç¢ºèª`,
    blocks: [
      {
        type: "section",
        text: {
          type: "mrkdwn",
          text: `ğŸ“† *${year}å¹´${month}æœˆ* ã®å‰¯æ¥­çŠ¶æ³ã‚’ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚\nç”³è«‹ID: *${applicationId}*`,
        },
      },
      {
        type: "actions",
        elements: ["ç¨¼åƒä¸­", "ç¨¼åƒãªã—", "å‰¯æ¥­çµ‚äº†"].map(status => ({
          type: "button",
          text: {
            type: "plain_text",
            text: status,
          },
          value: JSON.stringify({ applicationId, year, month, status }),
          action_id: "monthly_status_update",
        })),
      },
    ],
  };

  UrlFetchApp.fetch("https://slack.com/api/chat.postMessage", {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${SLACK_TOKEN}`,
    },
    payload: JSON.stringify(message),
  });
}
```

---

### â‘¢ ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã‚’å—ã‘å–ã‚‹Webhookï¼ˆ`doPost`ï¼‰

```javascript
function doPost(e) {
  const payload = JSON.parse(e.postData.contents);
  if (payload.type === "block_actions") {
    const action = payload.actions[0];
    const userId = payload.user.id;
    const value = JSON.parse(action.value); // { applicationId, year, month, status }

    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("MonthlyStatus");
    const now = new Date();

    sheet.appendRow([
      new Date().getTime(), // ãƒ¬ã‚³ãƒ¼ãƒ‰IDä»£æ›¿
      value.applicationId,
      value.year,
      value.month,
      value.status,
      getUserIdBySlackId(userId),
      Utilities.formatDate(now, "Asia/Tokyo", "yyyy/MM/dd HH:mm:ss"),
    ]);

    // ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ä¿¡
    return ContentService.createTextOutput(
      JSON.stringify({ text: "å›ç­”ã‚’è¨˜éŒ²ã—ã¾ã—ãŸã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼" })
    ).setMimeType(ContentService.MimeType.JSON);
  }

  return ContentService.createTextOutput("OK");
}
```

---

### â‘£ Slack ID â†’ ç¤¾å“¡IDã®å¤‰æ›

```javascript
function getUserIdBySlackId(slackId) {
  const users = getUserMap();
  for (const [userId, user] of Object.entries(users)) {
    if (user.slackId === slackId) return userId;
  }
  return null;
}
```

---

## âœ… ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ï¼ˆWebhookè¨­å®šï¼‰

1. GASã®`doPost`é–¢æ•°ãŒã‚ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’**Webã‚¢ãƒ—ãƒªã¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤**ã€‚
   - å®Ÿè¡Œã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼šè‡ªåˆ†
   - èª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆåŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¨±å¯ï¼‰
2. Slack Appè¨­å®šç”»é¢ã§ã€ŒInteractivity & Shortcutsã€ã‚’æœ‰åŠ¹ã«ã—ã€
   - Request URLã«Webã‚¢ãƒ—ãƒªã®URLã‚’ç™»éŒ²ã€‚
3. `sendMonthlyStatusCheck()` ã‚’æ¯æœˆ1æ—¥ã«ãƒˆãƒªã‚¬ãƒ¼å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«è¨­å®šã€‚

---

## â­ï¸ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

- AppSheet å´ã§ç¤¾å“¡ãŒéå»ã®å›ç­”ã‚’ç¢ºèªãƒ»ä¿®æ­£ã™ã‚‹UIã‚’ç”¨æ„
- ç®¡ç†è€…ç”¨ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆæœªå›ç­”è€…ã®æœˆæ¬¡ä¸€è¦§ï¼‰ä½œæˆ

ãã‚Œã‚‰ã®æ§‹ç¯‰ã‚‚å¿…è¦ã§ã‚ã‚Œã°ã‚µãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚ã©ã¡ã‚‰ã‹ã‚‰é€²ã‚ã¾ã™ã‹ï¼Ÿ

# è³ªå•ï¼”ï¼ˆto ChatGPTï¼‰
> AppSheet å´ã§ç¤¾å“¡ãŒéå»ã®å›ç­”ã‚’ç¢ºèªãƒ»ä¿®æ­£ã™ã‚‹UIã‚’ä½œæˆã—ã¦ãã ã•ã„

# å›ç­”ï¼”

AppSheet å´ã§ç¤¾å“¡ãŒã€Œè‡ªåˆ†ã®å‰¯æ¥­ç”³è«‹ã€ã«ç´ã¥ãã€Œæœˆæ¬¡ç¶™ç¶šå›ç­”å±¥æ­´ã€ã‚’ç¢ºèªãƒ»ä¿®æ­£ã§ãã‚‹UIï¼ˆãƒ“ãƒ¥ãƒ¼ï¼‰ã‚’æ§‹ç¯‰ã™ã‚‹ã«ã¯ã€**ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã§AppSheetã‚¢ãƒ—ãƒªã‚’è¨­è¨ˆ**ã—ã¾ã™ã€‚

---

## âœ… ç›®æŒ‡ã™UIã®ã‚¤ãƒ¡ãƒ¼ã‚¸

- ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆç¤¾å“¡ï¼‰ã¯ã€è‡ªåˆ†ã®ç”³è«‹ã ã‘ãŒè¦‹ãˆã‚‹ã€‚
- å„ç”³è«‹ã®è©³ç´°ãƒšãƒ¼ã‚¸ã§ã€å¯¾å¿œã™ã‚‹æœˆæ¬¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆ`MonthlyStatus`ï¼‰ã®ä¸€è¦§ã‚’ç¢ºèªã§ãã‚‹ã€‚
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç·¨é›†å¯èƒ½ï¼ˆä¾‹ï¼šã€Œç¨¼åƒä¸­ â†’ ç¨¼åƒãªã—ã€ã«ä¿®æ­£ï¼‰ã€‚
- æ–°è¦ã«æœˆæ¬¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã€‚

---

## ğŸ— AppSheetè¨­è¨ˆæ‰‹é †

### â‘  ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®ç”¨æ„ï¼ˆGoogle Spreadsheetï¼‰
ä½¿ç”¨ã‚·ãƒ¼ãƒˆï¼š
- `Users`
- `Applications`
- `MonthlyStatus`

### â‘¡ å„ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®š

#### `Users` ãƒ†ãƒ¼ãƒ–ãƒ«
| é …ç›® | è¨­å®šå†…å®¹ |
|------|----------|
| Security Filter | `[Slackãƒ¦ãƒ¼ã‚¶ãƒ¼ID] = USEREMAIL()` ãªã©SlackIDã‹ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ™ãƒ¼ã‚¹ã§åˆ¶é™ |
| Key Column | `ç¤¾å“¡ID` |

#### `Applications` ãƒ†ãƒ¼ãƒ–ãƒ«
| é …ç›® | è¨­å®šå†…å®¹ |
|------|----------|
| Security Filter | `[ç”³è«‹è€…ID] = LOOKUP(USEREMAIL(), "Users", "Slackãƒ¦ãƒ¼ã‚¶ãƒ¼ID", "ç¤¾å“¡ID")` |
| Key Column | `ç”³è«‹ID` |

#### `MonthlyStatus` ãƒ†ãƒ¼ãƒ–ãƒ«
| é …ç›® | è¨­å®šå†…å®¹ |
|------|----------|
| Security Filter | `[å›ç­”è€…ID] = LOOKUP(USEREMAIL(), "Users", "Slackãƒ¦ãƒ¼ã‚¶ãƒ¼ID", "ç¤¾å“¡ID")` |
| Key Column | `ãƒ¬ã‚³ãƒ¼ãƒ‰ID` |
| Ref | `ç”³è«‹ID` ã‚’ `Applications` ã«å¯¾ã—ã¦å‚ç…§å‹ã«è¨­å®š |

---

### â‘¢ UXãƒ“ãƒ¥ãƒ¼æ§‹æˆï¼ˆAppSheetï¼‰

#### A. ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ¥ãƒ¼ï¼š`My Applications`
- **View Type**ï¼šTable / Deck
- **Data**ï¼š`Applications`
- **Display name**ï¼š`è‡ªåˆ†ã®å‰¯æ¥­ç”³è«‹`
- **Row filter**ï¼šè‡ªèº«ã®ç”³è«‹ã®ã¿ï¼ˆä¸Šè¨˜Security Filterã§å¯¾å¿œï¼‰
- **On Row Click**ï¼š**Detail View**ã¸é·ç§»

#### B. Application Detailãƒ“ãƒ¥ãƒ¼
- **Data**ï¼š`Applications`
- **View Type**ï¼šDetail
- **è¡¨ç¤ºé …ç›®**ï¼š
  - å‰¯æ¥­å†…å®¹ãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ»ç¨¼åƒæ™‚é–“ãªã©
  - **Related MonthlyStatus**ï¼ˆä»®æƒ³åˆ—ï¼š`Related MonthlyStatus`ï¼‰

#### C. Embedded Tableï¼š`MonthlyStatus`ï¼ˆDetailå†…ï¼‰
- è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ä»®æƒ³åˆ— `Related MonthlyStatus` ã‚’è¡¨ç¤º
- å„æœˆã®å›ç­”ï¼ˆã€Œç¨¼åƒä¸­ã€ã€Œç¨¼åƒãªã—ã€ãªã©ï¼‰ã‚’ä¸€è¦§è¡¨ç¤º
- ç·¨é›†ãƒ»å‰Šé™¤å¯
- ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ã§æ–°è¦æœˆæ¬¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿½åŠ å¯èƒ½ï¼ˆ`ApplicationID` è‡ªå‹•é€£æºï¼‰

---

### â‘£ ãƒ•ã‚©ãƒ¼ãƒ ãƒ“ãƒ¥ãƒ¼ï¼šæ–°è¦æœˆæ¬¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä½œæˆç”¨

- ãƒ•ã‚©ãƒ¼ãƒ ã§å…¥åŠ›ã™ã‚‹é …ç›®ï¼š
  - å¹´ï¼ˆ`Enum`ï¼‰
  - æœˆï¼ˆ`Enum`ï¼‰
  - å›ç­”ï¼ˆ`Enum`: ç¨¼åƒä¸­ / ç¨¼åƒãªã— / å‰¯æ¥­çµ‚äº†ï¼‰
- å›ç­”æ—¥ï¼šåˆæœŸå€¤ã« `NOW()` ã‚’è¨­å®šï¼ˆéè¡¨ç¤ºã§ã‚‚OKï¼‰
- å›ç­”è€…IDï¼šåˆæœŸå€¤ã« `LOOKUP(USEREMAIL(), "Users", "Slackãƒ¦ãƒ¼ã‚¶ãƒ¼ID", "ç¤¾å“¡ID")`

---

### â‘¤ æ¨©é™ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ï¼ˆé‡è¦ï¼‰

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã—ã‹è¦‹ã›ãªã„ã‚ˆã†ã€**Security Filter**ã‚’ã™ã¹ã¦ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¨­å®šã€‚
- ç·¨é›†å¯¾è±¡ã‚’åˆ¶é™ã—ãŸã„å ´åˆã¯ã€`Editable_If` ãƒ«ãƒ¼ãƒ«ã§ã€Œè‡ªèº«ã®ãƒ‡ãƒ¼ã‚¿ã‹ã©ã†ã‹ã€ã‚’æ¡ä»¶ã«ã™ã‚‹ã€‚

---

## ğŸ“± ç”»é¢ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆæ§‹æˆä¾‹ï¼‰

```
My Applications
â”œâ”€ [Webåˆ¶ä½œ - æ ªå¼ä¼šç¤¾ABC]
â”‚   â”œâ”€ å‰¯æ¥­å†…å®¹: Webåˆ¶ä½œ
â”‚   â”œâ”€ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ: æ ªå¼ä¼šç¤¾ABC
â”‚   â”œâ”€ ç¨¼åƒè¦‹è¾¼ã¿: 20æ™‚é–“
â”‚   â”œâ”€ Related MonthlyStatus
â”‚   â”‚   â”œâ”€ 2025å¹´4æœˆ: ç¨¼åƒä¸­ï¼ˆç·¨é›†å¯ï¼‰
â”‚   â”‚   â”œâ”€ 2025å¹´5æœˆ: ç¨¼åƒãªã—ï¼ˆç·¨é›†å¯ï¼‰
â”‚   â”‚   â””â”€ [+æ–°è¦å›ç­”ã‚’è¿½åŠ ]
```

---

## âœ… å®Œæˆå¾Œã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] ã‚¢ãƒ—ãƒªã«ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸç¤¾å“¡ã¯ã€è‡ªåˆ†ã®ç”³è«‹ã ã‘è¦‹ãˆã‚‹ã€‚
- [x] å„ç”³è«‹ã«ç´ã¥ã„ãŸæœˆæ¬¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¦‹ã‚‰ã‚Œã‚‹ãƒ»ä¿®æ­£ã§ãã‚‹ã€‚
- [x] å¿…è¦ãªã‚‰æ–°ã—ã„æœˆã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿½åŠ ã§ãã‚‹ã€‚
- [x] ç®¡ç†è€…ã«ã¯å…¨ç¤¾å“¡åˆ†ãŒè¦‹ãˆã‚‹ã‚ˆã†ã€åˆ¥ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆå¯èƒ½ã€‚

---

ã”å¸Œæœ›ãŒã‚ã‚Œã°ã€Œç®¡ç†è€…å‘ã‘ã®æœªå›ç­”è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€ã®æ§‹æˆã‚‚ç¶šã‘ã¦ææ¡ˆã§ãã¾ã™ï¼ä½œã‚Šã¾ã—ã‚‡ã†ã‹ï¼Ÿ

# è³ªå•ï¼•ï¼ˆto ChatGPTï¼‰

> ç®¡ç†è€…å‘ã‘ã®æœªå›ç­”è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„

# è§£ç­”ï¼•

äº†è§£ã§ã™ï¼ä»¥ä¸‹ã«ã€**AppSheetã§æ§‹ç¯‰ã™ã‚‹ã€Œç®¡ç†è€…å‘ã‘æœªå›ç­”è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€**ã®è¨­è¨ˆã‚’ã¾ã¨ã‚ã¾ã™ã€‚

---

## ğŸ¯ ç›®çš„

- ç®¡ç†è€…ãŒæ¯æœˆã®å‰¯æ¥­ç¶™ç¶šç¢ºèªçŠ¶æ³ã‚’æŠŠæ¡ã—ã€**æœªå›ç­”è€…ã‚’ç‰¹å®šã—ã¦ç£ä¿ƒ**ã§ãã‚‹ã€‚
- å¹´ãƒ»æœˆã‚’æŒ‡å®šã—ã¦ã€å„ç”³è«‹ã«å¯¾ã—ã¦è©²å½“æœˆã®**æœˆæ¬¡å›ç­”ãŒå­˜åœ¨ã—ãªã„ç¤¾å“¡ã®ä¸€è¦§**ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
- è©²å½“ç”³è«‹ã®æƒ…å ±ã¨ã¨ã‚‚ã«ã€Slack IDã‚„åå‰ã€ç”³è«‹IDã‚‚è¡¨ç¤ºã€‚

---

## ğŸ§± å¿…è¦ãªè¦ç´ 

### ä½¿ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«
- `Applications`ï¼šå‰¯æ¥­ç”³è«‹ãƒ‡ãƒ¼ã‚¿
- `MonthlyStatus`ï¼šæœˆæ¬¡å›ç­”ãƒ‡ãƒ¼ã‚¿
- `Users`ï¼šç¤¾å“¡ãƒ‡ãƒ¼ã‚¿

---

## ğŸ— è¨­è¨ˆæ‰‹é †ï¼ˆAppSheetï¼‰

---

### â‘  ä»®æƒ³åˆ—ã‚’ç”¨ã„ã¦æœªå›ç­”ãƒ•ãƒ©ã‚°ã‚’ä½œæˆ

`Applications` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä»¥ä¸‹ã®ä»®æƒ³åˆ—ã‚’è¿½åŠ ï¼š

#### A. ä»®æƒ³åˆ—ï¼š`HasMonthlyResponse`
```appsheet
COUNT(
  SELECT(
    MonthlyStatus[ãƒ¬ã‚³ãƒ¼ãƒ‰ID],
    AND(
      [ç”³è«‹ID] = [_THISROW].[ç”³è«‹ID],
      [å¹´] = ANY(AppSettings[å¯¾è±¡å¹´]),
      [æœˆ] = ANY(AppSettings[å¯¾è±¡æœˆ])
    )
  )
) > 0
```

> ğŸ’¡ `AppSettings` ã¯ã€Œå¹´ã€ã¨ã€Œæœˆã€ã‚’ä¸€æ™‚çš„ã«ä¿æŒã™ã‚‹1è¡Œã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’å—ã‘ã‚‹ãŸã‚ã«ä½¿ç”¨ï¼‰

---

### â‘¡ ä»®æƒ³åˆ—ï¼š`IsUnanswered`

```appsheet
NOT([HasMonthlyResponse])
```

---

### â‘¢ Sliceï¼ˆãƒ“ãƒ¥ãƒ¼ã®å…ƒã«ãªã‚‹æŠ½å‡ºæ¡ä»¶ï¼‰

#### Sliceåï¼š`UnansweredApplications`
- **Table**ï¼š`Applications`
- **Row filter condition**ï¼š
```appsheet
AND(
  [IsUnanswered],
  ISNOTBLANK([é–‹å§‹æ—¥]),
  ISNOTBLANK([çµ‚äº†æ—¥]),
  TODAY() >= [é–‹å§‹æ—¥],
  TODAY() <= [çµ‚äº†æ—¥]
)
```

---

### â‘£ UXï¼šç®¡ç†è€…ç”¨ãƒ“ãƒ¥ãƒ¼ï¼ˆDashboardï¼‰

#### A. ãƒ“ãƒ¥ãƒ¼åï¼š`æœªå›ç­”è€…ãƒªã‚¹ãƒˆ`
- **View Type**ï¼šDashboard
- **Sub Views**ï¼š
  - `å¯¾è±¡å¹´æœˆé¸æŠ`ï¼ˆãƒ•ã‚©ãƒ¼ãƒ ï¼‰
  - `æœªå›ç­”è€…ä¸€è¦§`ï¼ˆTableï¼‰

#### B. å¹´æœˆé¸æŠãƒ“ãƒ¥ãƒ¼ï¼ˆAppSettingsãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ•ã‚©ãƒ¼ãƒ ï¼‰

- å˜ä¸€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã« `å¯¾è±¡å¹´`, `å¯¾è±¡æœˆ` ã‚’æŒãŸã›ã¦ã€
  - Enumã§å¹´ï¼ˆ2025,2026â€¦ï¼‰
  - Enumã§æœˆï¼ˆ1ã€œ12ï¼‰

#### C. æœªå›ç­”è€…ä¸€è¦§ãƒ“ãƒ¥ãƒ¼ï¼ˆTableï¼‰

- ãƒ‡ãƒ¼ã‚¿ï¼š`UnansweredApplications` ã‚¹ãƒ©ã‚¤ã‚¹
- è¡¨ç¤ºé …ç›®ï¼š
  - ç”³è«‹è€…åï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‚ç…§ã§è¡¨ç¤ºï¼‰
  - å‰¯æ¥­å†…å®¹
  - Slackãƒ¦ãƒ¼ã‚¶ãƒ¼ID
  - ç”³è«‹ID
  - ç”³è«‹æ—¥
- ä¸¦ã³é †ï¼šç”³è«‹è€…åã¾ãŸã¯ç”³è«‹æ—¥

---

## ğŸ§‘â€ğŸ’¼ ç®¡ç†è€…ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆä¾‹ï¼‰

- è¡Œã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ ç”³è«‹ã®è©³ç´°ã‚’ç¢ºèª
- Slack IDã‹ã‚‰å¤–éƒ¨é€£æºã—ã¦æ‰‹å‹•ã§DMé€ä¿¡ or GASçµŒç”±ã§ç£ä¿ƒãƒœã‚¿ãƒ³ã‚‚è¿½åŠ å¯èƒ½ï¼ˆAppSheetãƒœã‚¿ãƒ³ â†’ GAS Webhookï¼‰

---

## ğŸ“± UIã‚¤ãƒ¡ãƒ¼ã‚¸

```
[æœªå›ç­”è€…ãƒªã‚¹ãƒˆ] 2025å¹´4æœˆ ğŸ”½

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ ç”³è«‹è€…å     â”‚ SlackID â”‚ å‰¯æ¥­å†…å®¹       â”‚ ç”³è«‹æ—¥ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚ å±±ç”°å¤ªéƒ     â”‚ @yamada â”‚ Webåˆ¶ä½œ        â”‚ 3/10  â”‚
â”‚ ä½è—¤èŠ±å­     â”‚ @sato   â”‚ ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚° â”‚ 3/15  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… è¿½åŠ ã‚¢ã‚¤ãƒ‡ã‚¢ï¼ˆä»»æ„ï¼‰

- `ç£ä¿ƒãƒœã‚¿ãƒ³ï¼ˆActionï¼‰` ã‚’è¿½åŠ ã—ã€GAS Webhook çµŒç”±ã§ Slack DM ã‚’é€ä¿¡ã€‚
- `AppSettings` ã®å¯¾è±¡å¹´æœˆã‚’ã€ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ä¿æŒã§ãã‚‹ã‚ˆã† `USEREMAIL()` ã«ã²ã‚‚ã¥ã‘ã€‚

---

## æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

1. AppSheet ã§ `AppSettings` ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã€å¹´ãƒ»æœˆã‚’å…¥åŠ›å¯èƒ½ã«ã™ã‚‹ã€‚
2. `Applications` ã«ä»®æƒ³åˆ— `HasMonthlyResponse` ã‚’è¿½åŠ ã€‚
3. `UnansweredApplications` ã‚¹ãƒ©ã‚¤ã‚¹ã‚’ä½œæˆã€‚
4. Dashboard ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆã—ã€ç®¡ç†è€…å‘ã‘ã®æœˆåˆ¥ç¢ºèªãƒ“ãƒ¥ãƒ¼ã‚’å®Œæˆï¼

---

å¿…è¦ã§ã‚ã‚Œã°ã€**ã€ŒSlackã§æœªå›ç­”è€…ã¸ä¸€æ‹¬ç£ä¿ƒã€** ã™ã‚‹GASã‚³ãƒ¼ãƒ‰ã‚‚ä½œæˆã§ãã¾ã™ã€‚ã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ

# è³ªå•ï¼–ï¼ˆto ChatGPTï¼‰

> Slackã§æœªå›ç­”è€…ã¸ä¸€æ‹¬ç£ä¿ƒã™ã‚‹GASã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„

# å›ç­”ï¼–

ä»¥ä¸‹ã«ã€**Slackã§æœªå›ç­”è€…ã¸ä¸€æ‹¬ç£ä¿ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’DMé€ä¿¡**ã™ã‚‹Google Apps Scriptï¼ˆGASï¼‰ã®ã‚³ãƒ¼ãƒ‰ã‚’æç¤ºã—ã¾ã™ã€‚

---

## ğŸ¯ ç›®çš„

- AppSheetã§æŒ‡å®šã—ãŸã€Œå¯¾è±¡å¹´æœˆã€ã«å¯¾ã—ã¦ã€Spreadsheetã§æœªå›ç­”ã®ç¤¾å“¡ï¼ˆ`Applications` ã«è©²å½“ãŒã‚ã‚Šã€`MonthlyStatus` ã«è©²å½“ãŒãªã„ï¼‰ã‚’æŠ½å‡ºã€‚
- ãã®ç¤¾å“¡ã« Slack DM ã§ã€Œç¶™ç¶šç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¸€æ‹¬ã§é€ä¿¡ã€‚

---

## ğŸ“ ä½¿ç”¨ã‚·ãƒ¼ãƒˆ

- `Applications`ï¼šå‰¯æ¥­ç”³è«‹
- `MonthlyStatus`ï¼šæœˆæ¬¡å›ç­”
- `Users`ï¼šç¤¾å“¡æƒ…å ±ï¼ˆSlack ID å«ã‚€ï¼‰
- `AppSettings`ï¼šå¯¾è±¡å¹´æœˆã‚’ä¿æŒï¼ˆ1è¡Œã®ã¿ï¼‰

---

## ğŸ§© GASã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼šæœªå›ç­”è€…ã¸ã®DMä¸€æ‹¬é€šçŸ¥

```javascript
const SLACK_TOKEN = PropertiesService.getScriptProperties().getProperty("SLACK_BOT_TOKEN");

function notifyUnansweredUsers() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const appSheet = ss.getSheetByName("Applications");
  const statusSheet = ss.getSheetByName("MonthlyStatus");
  const usersSheet = ss.getSheetByName("Users");
  const settingsSheet = ss.getSheetByName("AppSettings");

  // å¹´æœˆå–å¾—
  const [_, targetYear, targetMonth] = settingsSheet.getRange(2, 1, 1, 3).getValues()[0];

  const applications = appSheet.getDataRange().getValues();
  const statuses = statusSheet.getDataRange().getValues();
  const users = usersSheet.getDataRange().getValues();

  const userMap = {};
  for (let i = 1; i < users.length; i++) {
    const [userId, name, slackId] = users[i];
    userMap[userId] = { name, slackId };
  }

  // å¿œç­”æ¸ˆã¿ applicationId + userId ã®ã‚»ãƒƒãƒˆ
  const answeredSet = new Set();
  for (let i = 1; i < statuses.length; i++) {
    const [_, appId, year, month] = statuses[i];
    if (year == targetYear && month == targetMonth) {
      answeredSet.add(`${appId}`);
    }
  }

  const today = new Date();
  const unansweredList = [];

  for (let i = 1; i < applications.length; i++) {
    const row = applications[i];
    const [ç”³è«‹ID, ç”³è«‹è€…ID, , , , é–‹å§‹æ—¥, çµ‚äº†æ—¥] = row;
    const start = new Date(é–‹å§‹æ—¥);
    const end = new Date(çµ‚äº†æ—¥);

    if (today >= start && today <= end && !answeredSet.has(ç”³è«‹ID)) {
      unansweredList.push({ ç”³è«‹ID, ç”³è«‹è€…ID });
    }
  }

  // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
  unansweredList.forEach(({ ç”³è«‹ID, ç”³è«‹è€…ID }) => {
    const user = userMap[ç”³è«‹è€…ID];
    if (!user?.slackId) return;

    const message = `
ğŸ”” *å‰¯æ¥­ç¶™ç¶šçŠ¶æ³ã®ç¢ºèªï¼ˆ${targetYear}å¹´${targetMonth}æœˆï¼‰*

ç”³è«‹ID: ${ç”³è«‹ID}
ä¸Šè¨˜ç”³è«‹ã®ä»Šæœˆã®å‰¯æ¥­ç¶™ç¶šçŠ¶æ³ãŒæœªå›ç­”ã§ã™ã€‚
AppSheet ã¾ãŸã¯Slacké€šçŸ¥ã‚ˆã‚Šã”å›ç­”ãã ã•ã„ã€‚
`;

    postSlackMessageToUser(user.slackId, message);
  });
}

// Slack DMé€ä¿¡å‡¦ç†
function postSlackMessageToUser(slackUserId, message) {
  // DMãƒãƒ£ãƒ³ãƒãƒ«ã‚’é–‹ã
  const imOpenUrl = "https://slack.com/api/conversations.open";
  const imOptions = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${SLACK_TOKEN}`,
    },
    payload: JSON.stringify({ users: slackUserId }),
  };
  const response = JSON.parse(UrlFetchApp.fetch(imOpenUrl, imOptions).getContentText());
  const channelId = response.channel.id;

  // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
  const payload = {
    channel: channelId,
    text: message,
    mrkdwn: true,
  };

  const options = {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${SLACK_TOKEN}`,
    },
    payload: JSON.stringify(payload),
  };

  UrlFetchApp.fetch("https://slack.com/api/chat.postMessage", options);
}
```

---

## âœ… è£œè¶³ï¼š`AppSettings` ã®æ§‹æˆä¾‹

| ã‚­ãƒ¼å       | å¯¾è±¡å¹´ | å¯¾è±¡æœˆ |
|--------------|--------|--------|
| CurrentMonth | 2025   | 4      |

â€»GASå´ã§2è¡Œç›®ï¼ˆ`getRange(2, 1, 1, 3)`ï¼‰ã‚’èª­ã‚“ã§ã„ã¾ã™ã€‚å¿…è¦ã«å¿œã˜ã¦èª¿æ•´ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ•˜ å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°

- AppSheetã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ä¸Šã§ã€Œç£ä¿ƒãƒœã‚¿ãƒ³ã€ã«ã“ã®GASé–¢æ•°ã‚’WebhookçµŒç”±ã§ç´ã¥ã‘ã€‚
- ã¾ãŸã¯ã€ç®¡ç†è€…ãŒGASä¸Šã§æ‰‹å‹•å®Ÿè¡Œã€‚

---

## ğŸ” äº‹å‰æº–å‚™ï¼ˆå†æ²ï¼‰

- Slack App ã®ã‚¹ã‚³ãƒ¼ãƒ—ã« `chat:write`, `im:write` ãŒå¿…è¦ã§ã™ã€‚
- Slack Bot Token ã¯ `SLACK_BOT_TOKEN` ã¨ã„ã†ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«è¨­å®šã€‚

---

ã”å¸Œæœ›ãŒã‚ã‚Œã°ã€ã€ŒAppSheet ã® Action ã‹ã‚‰ã“ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™ã€é€£æºæ–¹æ³•ã‚‚ã”æ¡ˆå†…ã§ãã¾ã™ã€‚å¿…è¦ã§ã™ã‹ï¼Ÿ

# è³ªå•ï¼—ï¼ˆto ChatGPTï¼‰

> AppSheet ã® Action ã‹ã‚‰ã“ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™é€£æºæ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„

# å›ç­”ï¼—

äº†è§£ã—ã¾ã—ãŸï¼  
ä»¥ä¸‹ã«ã€**AppSheetã®Actionï¼ˆãƒœã‚¿ãƒ³ï¼‰ã‹ã‚‰GASã® `notifyUnansweredUsers()` é–¢æ•°ã‚’å‘¼ã³å‡ºã™æ‰‹é †**ã‚’ã¾ã¨ã‚ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç®¡ç†è€…ãŒAppSheetã®UIã‹ã‚‰ãƒœã‚¿ãƒ³1ã¤ã§Slackç£ä¿ƒã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

---

## âœ… æ§‹æˆã‚¤ãƒ¡ãƒ¼ã‚¸

- AppSheetä¸Šã«ã€ŒSlackã§æœªå›ç­”è€…ã‚’ç£ä¿ƒã™ã‚‹ã€ãƒœã‚¿ãƒ³ï¼ˆActionï¼‰ã‚’ä½œæˆ
- ãã®ãƒœã‚¿ãƒ³ã¯GASã®Webã‚¢ãƒ—ãƒªï¼ˆWebhookï¼‰ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹
- Webã‚¢ãƒ—ãƒªå†…ã§ `notifyUnansweredUsers()` ã‚’å‘¼ã³å‡ºã—ã¦ä¸€æ‹¬é€ä¿¡å‡¦ç†ã‚’å®Ÿè¡Œ

---

## ğŸ§© ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—

---

### â‘  GASã‚’Webã‚¢ãƒ—ãƒªã¨ã—ã¦å…¬é–‹

1. GASã‚¨ãƒ‡ã‚£ã‚¿ã§ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ï¼š

```javascript
function doPost(e) {
  const token = ScriptProperties.getProperty("WEBHOOK_SECRET"); // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç”¨
  const payload = JSON.parse(e.postData.contents);

  if (payload.token !== token) {
    return ContentService.createTextOutput("Invalid token").setMimeType(ContentService.MimeType.TEXT);
  }

  // é€šå¸¸ã®Slacké€šçŸ¥å‡¦ç†ã‚’å®Ÿè¡Œ
  notifyUnansweredUsers();

  return ContentService.createTextOutput("ç£ä¿ƒé€šçŸ¥ã‚’é€ä¿¡ã—ã¾ã—ãŸ").setMimeType(ContentService.MimeType.TEXT);
}
```

2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä»¥ä¸‹ã‚’è¨­å®šï¼š
   - `WEBHOOK_SECRET`: ä»»æ„ã®é•·ã„æ–‡å­—åˆ—ï¼ˆä¾‹: `abc123456789secret`ï¼‰

3. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã‚’é¸æŠï¼š
   - å®Ÿè¡Œã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼šè‡ªåˆ†
   - ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼š**åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆèª°ã§ã‚‚ï¼‰**
   - ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€**Webã‚¢ãƒ—ãƒªã®URLã‚’ã‚³ãƒ”ãƒ¼**ï¼ˆä¾‹: `https://script.google.com/macros/s/XXXXX/exec`ï¼‰

---

### â‘¡ AppSheetã§Webhookã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ

1. **AppSheetã®ç®¡ç†ç”»é¢ã¸**  
2. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ `Behavior` > `Actions` ã‚’é¸æŠ
3. `New Action` ã‚’ä½œæˆï¼š

| é …ç›®                | å†…å®¹                                                                 |
|---------------------|----------------------------------------------------------------------|
| For a record of     | `AppSettings`ï¼ˆã¾ãŸã¯å›ºå®šå€¤ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰                                     |
| Name                | `æœªå›ç­”è€…ã«Slackã§ç£ä¿ƒ`                                                   |
| Do this             | `Webhook`                                                           |
| URL                 | `https://script.google.com/macros/s/XXXXX/exec`ï¼ˆâ†‘ã§ã‚³ãƒ”ãƒ¼ã—ãŸURLï¼‰        |
| HTTP Content Type   | `JSON`                                                               |
| HTTP Verb           | `POST`                                                               |
| Body                | `{"token": "abc123456789secret"}`ï¼ˆâ†‘ã§è¨­å®šã—ãŸç§˜å¯†ãƒˆãƒ¼ã‚¯ãƒ³ã¨åŒã˜ï¼‰          |

---

### â‘¢ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ“ãƒ¥ãƒ¼ã«è¡¨ç¤º

1. `UX > Views` ã§ç®¡ç†è€…ç”¨ã®ãƒ“ãƒ¥ãƒ¼ï¼ˆä¾‹: `æœªå›ç­”è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰`ï¼‰ã‚’é–‹ã
2. `Display > Event Actions` ã§ã€Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã€ã«è¨­å®š
3. `Display prominently` ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ã€ä¸Šéƒ¨ã«è¡¨ç¤º

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ‰‹é †

1. `AppSettings` ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾è±¡å¹´æœˆã‚’å…¥åŠ›
2. ç®¡ç†è€…ãƒ“ãƒ¥ãƒ¼ã§ã€Œæœªå›ç­”è€…ã«Slackã§ç£ä¿ƒã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™
3. Slackã§æœªå›ç­”ç¤¾å“¡ã«DMãŒå±Šãã“ã¨ã‚’ç¢ºèª

---

## âœ… è£œè¶³ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆæ¨å¥¨ï¼‰

- GASã® `doPost` ã«ç§˜å¯†ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä»˜ã‘ã‚‹ã“ã¨ã§ã€**ä¸æ­£ãªå¤–éƒ¨ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’é˜²æ­¢**
- Bot Tokenã‚„Webhook Secretã¯**Script Properties**ã«ä¿å­˜ã—ã¦ã€ã‚³ãƒ¼ãƒ‰å†…ã«ç›´æ›¸ãã—ãªã„

---


# æ‰€æ„Ÿ
- GASã¯ã„ã¤ã‚‚ä½œã£ã¦ã‚‚ã‚‰ã£ã¦ãŸã‘ã©ã€Appsheetä½œã£ã¦ãã‚Œã£ã¦è¨€ã£ãŸã‚‰ã“ã†ã„ã†ã‹ã‚“ã˜ã«ãªã‚‹ã®ã‹ã‚
